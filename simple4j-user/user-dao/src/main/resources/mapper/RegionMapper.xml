<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.simple4j.user.dao.RegionMapper">

	<select id="lazyList" resultType="com.simple4j.user.entity.Region">
		SELECT
		region.*,
		( SELECT CASE WHEN count( 1 ) > 0 THEN 1 ELSE 0 END FROM simple4j_region WHERE parent_code =
		region.code ) AS
		"has_children"
		FROM
		simple4j_region region
		<where>
			<if test="parentCode!=null">
				and region.parent_code = #{parentCode}
			</if>
			<if test="code!=null and code!=''">
				and region.code like concat(concat('%', #{code}),'%')
			</if>
			<if test="name!=null and name!=''">
				and region.name like concat(concat('%', #{name}),'%')
			</if>
		</where>
	</select>
	<select id="detail" resultType="com.simple4j.user.entity.Region">
		SELECT
		region.*,
		(SELECT name  FROM simple4j_region WHERE code = region.parent_code ) AS  parent_name
		FROM
		simple4j_region region
		where  code = #{code}
	</select>

</mapper>
